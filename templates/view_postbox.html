{% extends 'base.html' %}

{% block content %}
<div class="flex-1 flex flex-col items-center justify-center px-6 py-12 max-w-2xl mx-auto w-full text-center">

    <div class="mb-4">
        <span id="badge" class="px-3 py-1.5 rounded-full text-xs font-bold shadow-sm 
              {{ 'bg-green-500' if privacy == 'public' else 'bg-slate-500' }} text-white">
            {{ 'ğŸ”“ ëª¨ë‘ì—ê²Œ ê³µê°œ' if privacy == 'public' else 'ğŸ”’ ë‚˜ë§Œ ë³´ê¸°' }}
        </span>
    </div>

    <h1 class="text-3xl font-black text-slate-900 dark:text-white mb-8">{{ postbox_name }}</h1>

    <div class="relative mb-10 animate-float">
        <img src="/static/images/postbox/{{ color }}.png" class="w-64 h-64 object-contain drop-shadow-2xl mx-auto">
        <div class="mt-6 text-slate-600 dark:text-slate-300">
            í˜„ì¬ <span class="text-primary font-bold text-2xl">12</span>ê°œì˜ í¸ì§€ê°€ ë‹´ê²¨ìˆì–´ìš”!
        </div>
    </div>

    <div class="w-full max-w-sm">
        {% if is_owner %}
        {% if is_expired %}
        <button onclick="location.href='/inbox/{{ postbox_name }}'"
            class="w-full py-5 bg-accent text-slate-900 rounded-2xl font-bold text-xl shadow-xl hover:scale-[1.02] transition-all">
            ğŸ“© ë„ì°©í•œ ë©”ì‹œì§€ ì½ê¸°
        </button>
        {% else %}
        <div class="bg-slate-100 dark:bg-slate-800 p-6 rounded-3xl border-2 border-dashed border-slate-300">
            <p class="text-sm text-slate-500 mb-3">ë©”ì‹œì§€ ê³µê°œê¹Œì§€ ë‚¨ì€ ì‹œê°„</p>
            <div id="countdown" class="text-3xl font-black tracking-widest text-primary">00:00:00:00</div>
            <p class="mt-4 text-xs text-slate-400 font-medium">í¸ì§€ëŠ” 1ì›” 1ì¼ì— ì—´ì–´ë³¼ ìˆ˜ ìˆì–´ìš”!</p>
        </div>
        {% endif %}

        {% else %}
        <button onclick="location.href='/write/{{ postbox_name }}?color={{ color }}'"
            class="w-full py-5 bg-primary text-white rounded-2xl font-bold text-xl shadow-xl hover:scale-[1.02] transition-all">
            âœï¸ í¸ì§€ ë‚¨ê¸°ê¸°
        </button>
        <p class="mt-4 text-slate-400 text-sm">ìµëª…ìœ¼ë¡œ ë”°ëœ»í•œ ë§ˆìŒì„ ì „ë‹¬í•˜ì„¸ìš”.</p>
        {% endif %}
    </div>
</div>

<script>
    // ì£¼ì¸ì´ê³  ì•„ì§ ì‹œê°„ì´ ì•ˆ ì§€ë‚¬ì„ ë•Œë§Œ ì‹¤í–‰
    {% if is_owner and not is_expired %}
    function updateCountdown() {
        const now = new Date();
        const target = new Date("2026-01-01T00:00:00"); // í…ŒìŠ¤íŠ¸ ì‹œ ë¯¸ë˜ ë‚ ì§œë¡œ ì„¤ì •
        const diff = target - now;

        if (diff <= 0) {
            location.reload(); // ì‹œê°„ì´ ë‹¤ ë˜ë©´ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì„œ 'ë©”ì‹œì§€ ì½ê¸°' ë²„íŠ¼ìœ¼ë¡œ ì „í™˜
            return;
        }

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
        const mins = Math.floor((diff / (1000 * 60)) % 60);
        const secs = Math.floor((diff / 1000) % 60);

        document.getElementById('countdown').innerText =
            `${days}d ${String(hours).padStart(2, '0')}h ${String(mins).padStart(2, '0')}m ${String(secs).padStart(2, '0')}s`;
    }
    setInterval(updateCountdown, 1000);
    updateCountdown();
    {% endif %}
</script>
{% endblock %}