{% extends 'base.html' %}

{% block content %}
<div class="flex-1 flex items-center justify-center px-6 py-12">
    <div class="w-full max-w-md animate-fade-in">
        
        <div class="text-center mb-10">
            <div class="inline-block p-3 bg-blue-50 dark:bg-blue-900/30 rounded-2xl mb-4">
                <span class="text-3xl">ğŸ“®</span>
            </div>
            <h2 class="text-2xl font-bold font-serif text-slate-900 dark:text-white">ìš°ì²´í†µ ë§Œë“¤ê¸°</h2>
            <p class="text-slate-500 dark:text-slate-400 mt-2">{{ user_name }}ë‹˜ì˜ ì†Œì¤‘í•œ ë§ì”€ì„ ë‹´ì„ ê³µê°„ì…ë‹ˆë‹¤.</p>
        </div>

        <div class="bg-white dark:bg-slate-800 rounded-3xl p-8 shadow-xl border border-slate-100 dark:border-slate-700">
            <form id="mailbox-form" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 ml-1">ìš°ì²´í†µ ì´ë¦„</label>
                    <input type="text" id="mailbox-name" 
                        class="w-full px-4 py-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary outline-none transition-all dark:text-white"
                        value="{{ user_name }}ë‹˜ì˜ ìš°ì²´í†µ" 
                        placeholder="ìš°ì²´í†µ ì´ë¦„ì„ ì •í•´ì£¼ì„¸ìš”">
                </div>

                <div>
                    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 ml-1">ë‚˜ì—ê²Œ í•˜ê³  ì‹¶ì€ í•œ ë§ˆë””</label>
                    <textarea id="prayer-topic" rows="3"
                        class="w-full px-4 py-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary outline-none transition-all dark:text-white resize-none"
                        placeholder="ì˜¬í•´ ë‚˜ì—ê²Œ ì£¼ëŠ” ì‘ì›ì˜ ë©”ì‹œì§€ë‚˜ ê¸°ë„ì œëª©ì„ ì ì–´ì£¼ì„¸ìš”."></textarea>
                </div>

                <button type="button" onclick="createMailbox()"
                    class="w-full py-4 bg-primary dark:bg-accent hover:opacity-90 text-white dark:text-slate-900 font-bold rounded-xl shadow-lg transition-all transform active:scale-[0.98]">
                    ìš°ì²´í†µ ìƒì„±í•˜ê¸°
                </button>
            </form>
        </div>
    </div>
</div>

<script>
async function createMailbox() {
    const name = document.getElementById('mailbox-name').value;
    const prayer = document.getElementById('prayer-topic').value;

    const response = await fetch('/api/create-mailbox', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name: name, prayer_topic: prayer })
    });

    const data = await response.json();
    if (data.mailbox_id) {
        // ìƒì„± ì™„ë£Œ í›„ ë³¸ì¸ì˜ ìš°ì²´í†µ ì£¼ì†Œë¡œ ì´ë™í•˜ê±°ë‚˜ ëª¨ë‹¬ ë„ìš°ê¸°
        window.location.href = `/mailbox/${data.mailbox_id}`;
    }
}
</script>
{% endblock %}